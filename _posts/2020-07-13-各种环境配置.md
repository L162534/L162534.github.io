---
layout:  post
title:  各种环境配置
subtitle:  抓紧学！来不及了
date:  2020-07-13
author:  L&X
catalog:  true
tags:
    
---

# Anaconda相关

## Anaconda创建虚拟环境

* **conda create -n env_name python=x.x**

创建python版本为x.x，环境名称为env_name的虚拟环境

* **activate env**

  激活名称为env的虚拟环境

* **deactivate env**

  退出当前的虚拟环境

* **conda remove -n env_name --all**

  删除所指定的环境

* **conda remove -n env_name package_name**

  删除指定环境的指定包

## 将虚拟环境配置到jupterbook

1. 激活待添加的环境

   ```
   activate env
   ```

2. 安装ipykernel

   ```
   pip ipykernel
   ```

3. 添加kernel

   ```
   python -m ipykernel install --user --name env_name --display-name kernel_name
   ```

   将名称为env_name的虚拟环境添加到jupterbook的kernel上，名称为kernel_name

## 更改jupyter notebook的工作路径

1. 找到jupyter_notebook_config.py,找到c.NotebookApp.notebook_dir，去掉前面的注释，后面加上自己设定的路径
2. 更改之后可通过在命令行调用jupyter notebook即可转换到设定的目录，如果直接调用之前的快捷方式，可能会出现工作目录未发生改变的现象，此时需要更改快捷方式的目标，右键快捷方式选择属性，去掉目标中最后面的带双引号的宏定义片段即可。

# tensorflow相关

## 运行tensorboard

1. 首先要选择包含tensorboard的虚拟环境

   ```
   activate env
   ```

2. 运行tensorboard命令

   ```
    tensorboard --logdir="D:\Documents\PycharmProject\cigarette_detection\logs\Fri_Jul_10_20_21_44_2020"
   ```

   logdir是日志文件的绝对路径

## 无法调用cudnn解决方法

```
This is probably because cuDNN failed to initialize
```

报这种错误抛开tensorflow、cuda、cudnn版本不匹配的问题，很大可能就是显存满了，可以通过任务管理器观察gpu的内存占用率。特别是在tensorflow2.x中，由于采用动态模式，如果不对gpu资源进行配置，只要执行一个数据操作，就会霸占所有gpu资源，导致cudnn初始化失败。

tf2的gpu采用自适应显存配置

```
tf.config.gpu.set_per_process_memory_growth(enabled=True)
```

```
# 上面的不行用下面的
import os
os.environ["CUDA_VISIBLE_DEVICES"] = '0'
gpus = tf.config.experimental.list_physical_devices(device_type='GPU')
for gpu in gpus:
    tf.config.experimental.set_memory_growth(gpu, True)
```

## 切换cuda版本

在环境变量path中：

C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v10.0\bin

C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v10.0\libnvvp

这两条用哪个cuda版本就将谁的放在最前面，这样在windows命令行用nvcc -V的命令，显示的cuda就会是你选择的版本。不过貌似tensorflow会自动寻找合适自己版本的cuda，就算我命令行显示的10.1，最后程序调用的链接库依然是10.0的

# C++相关

## 配置opencv

1. 将opencv\build\x64\vc15\bin配置到系统变量中

2. 新建一个属性管理表

3. VC++目录中的包含目录添加

   opencv\build\include

   opencv\build\include\opencv2

4. VC++目录中的库目录添加

   opencv\build\x64\vc15\lib

5. 链接器的输入中添加

   opencv_world440d.lib

   opencv_world440.lib

