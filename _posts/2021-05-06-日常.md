---
layout:  post
title:  日常
subtitle:  keep moving
date:  2021-05-06
author:  LY
catalog:  true
tags:
    -linux
---

## cpu种类

我们使用的软件都要经过cpu内部的微指令集来完成，指令集的设计分为两种设计理念：

* 精简指令集(Reduced Instruction Set Computing) RISC

  每个指令的执行时间都很短，完成的操作也很简单，执行性能较好，如果需要做很复杂的事情就需要多个指令来完成。常见的RISC微指令集cpu主要有**SPARC**架构(用于学术领域的大型工作站等)，**PowerPC**架构(PS3就是使用PowerPC架构的Cell处理器)，**ARM**架构(使用范围最广的cpu，领域包括手机，导航系统，网络设备等)

* 复杂指令集(Complex Instruction Set Computing) CISC

  CSIC的微指令集中，每个小指令可以执行一些较低阶的硬件操作，指令数目多而且复杂，每条指令花费时间长，单每条指令可以处理的工作较为丰富，常见的CISC微指令集包括**AMD**,**Intel**,**VIA**等x86的cpu

## 内存

* 个人计算机的内存主要组件为动态随机访问内存(Dynamic Random Access Memory ,DRAM),只有通电的时候才能记录和使用，DRAM的实际应用最广泛的主要分两种：**SDRAM**，**DDR SDRAM**，主要区别在于DDR(Double Data Rate)是双倍数据传送速度

* cpu内部也有内存(L2 Cache)，主要存储很常用的程序和数据，从而大大缩减数据从DRAM到cpu的时间，但是内存的速度必须与cpu的频率相同，DRAM无法达到这种速度，需要用静态随机访问内存(Static Random Access Memory, SRAM),SRAM具有速度快，不易做成大容量的特点
* 只读存储器(Read Only Memory,ROM)，比如BIOS(Basic Intput Onput System)这套程序就是写死在主板上的一个ROM里，但是计算机发展太快了，BIOS程序代码可能需要做适度的修改，ROM不可写，所以现在的BIOS通常是写入闪存(Flash Memory)或者带点可擦写可编程只读存储器(Electrically Erasable and Programmable Read Only Memory,EEPROM)；主板内有个CMOS芯片，专门用来记录主板上面的重要参数：系统时间，cpu电压与频率，各项设备的I/O地址与IRQ等，由于这些数据的记录要花费电，所以主板上会有电池，CMOS上的参数可以通过BIOS来修改。另外， 很多固件(firmware)也是使用ROM来将软件写入，固件也是像软件一样被计算机执行的程序，但是它是对硬件内部而言更重要的部分。

## 操作系统

在早期想要让计算机执行程序就得参考一堆硬件功能函数，并且要学习机器语言才能编写程序，每次写程序时都必须要重新改写，因为硬件与软件的功能不一定一致，如果能将所有的硬件都驱动，并且提供一个开发软件的参考接口来给工程师开发软件，就会变得非常简单，这就是操作系统做的事。

操作系统其实也是一组程序，这组程序的重点在于管理计算机所有活动以及驱动系统中的所有硬件。操作系统在真个程序执行流程中起到了操作系统内核和系统调用的作用



![](D:\Documents\GitHub\L162534.github.io\img\linux-1.jpg)

* 操作系统内核

  内核主要用于管控硬件，提供硬件相关功能，提供合理的系统资源分配，比如让内存读取加载数据，让网卡传输数据。如果硬件不同如果cpu架构不一样就需要修改内核。

  内核需要实现的最基本功能：

  1. 系统调用接口

     既然硬件都有内核控制管理，如果我们编写代码要操纵硬件就不需要参考硬件函数了，而是要参考内核功能，为了解决这个问题，操作系统通常会提供一组开发接口。同时系统调用层也起到了保护内核的作用，避免用户直接操作内核导致系统崩溃。

  2. 程序管理

     计算机可能同时有很多工作在等待cpu进行处理，内核这个时候就必须要对cpu的资源进行合理分配。

  3. 内存管理

     控制整个系统的内存管理，通常内核会提供虚拟内存的功能，当内存不足时可以提供内存交换的功能。

  4. 文件系统管理

     例如数据的输入输出等的工作，还有对不同文件格式的支持。

  5. 设备驱动

     设备的驱动程序就是内核需要做的事情，事实上，驱动程序的提供应该是硬件厂商的事情，驱动程序是硬件厂商参考操作系统的驱动程序开发的接口，用户使用时依然是通过操作系统的接口来调用驱动程序进而操作硬件，现在可以直接将驱动程序编辑成模块，就不需要重新编译内核了。

  ## 开机流程
  * 主引导分区(Master Boot Record，MBR)

    位于硬盘的第一物理扇区，由于历史原因，硬盘的一个扇区的大小是512字节，包含最多446字节的启动代码也就是引导程序，4个硬盘分区表项(Disk Partition Table,DPT),每个表项16个字节，共64个字节，2个签名字节(0x55,0xAA)

  整个开机流程：
  
  1. BIOS：开机主动执行的代码，会找到第一个可开机的设备
  2. MBR：第一个可开机设备的第一个扇区内的主引导分区块，内包含引导加载程序
  3. 引导加载程序(Boot loader): 可读取内核文件来执行的软件，主要功能有：
     * 提供菜单：用户可以选择不同的开机选项，这也是多重引导的重要功能
     * 载入内核文件：直接指向可开机的程序区段来开始操作系统
     * 转交其他loader:将引导加载功能转交给其他loader负责，这也是一台主机能装多系统的原因，Boot loader除了可以安装在MBR之外，还可以安装在每个分区的引导扇区(boot sector)
  4. 内核文件：开始执行操作系统的功能
  
# brainstorming

  * 装双系统时，先装windows再装linux，如果先装linux，装windows时windows安装程序会主动覆盖掉MBR以及自己所在分区的启动扇区，从而无法进入菜单选择画面